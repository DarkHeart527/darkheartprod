<html>
	<head>
		<style>
		body {
		 margin: 0px;
		}
		header {
		 display: grid;
		 width: 100%;
		 height: 10%;
		 grid-template-columns: 1fr 1fr 1fr;
		 align-items: center;
		 justify-items: center;
		}
		.earn {
		 width: 90%;
		 height: 40%;
		 margin: 0 auto;
		}
		.stats {
		 width: 40%;
		 height: 40%;
		 margin-left: 10%;
		 clear: both;
		 float: left;
		 margin-top: 1%;
		}
		.refer {
		 width: 40%;
		 height: 20%;
		 float: right;
		 margin-right: 7.5%;
		 margin-top: 5%;
		}
		#referId {
		 cursor: pointer;
		}
		footer {
		 width: 100%;
		 height: 10%;
		 position: absolute;
		 bottom: -10%;
		}
		.overlay {
		 background-color: rgba(0, 0, 0, 0.5);
		 position: fixed;
		 top: 0px;
		 font-size: 35px;
		 left: 0px;
		 width: 100%;
		 height: 100%;
		 display: grid;
		 align-items: center;
		 justify-items: center;
		}
		#signIn, #signUpDetails {
		 position: fixed;
		 top: 0px;
		 left: 0px;
		 width: 100%;
		 height: 100%;
		 display: grid;
		 align-items: center;
		 justify-items: center;
		 background-color: rgba(0, 0, 0, .5);
		}
		#signInButton {
		 display: grid;
		 grid-template-columns: 1fr 3fr;
		 height: fit-content;
		 border: 1px solid black;
		 border-radius: 25px;
		 justify-items: center;
		 align-items: center;
		 cursor: pointer;
		 padding: 5px;
		}
		#signInButton img {
		 width: 50px;
		 height: 50px;
		}
		@keyframes dark {
			0% {color: orange}
			20% {color: transparent;text-shadow: 5px 5px 2px black}
			40% {color: transparent;text-shadow: 5px -5px 2px black}
			60% {color: transparent;text-shadow: -5px -5px 2px black}
			80% {color: transparent;text-shadow: -5px 5px 2px black}
			100% {color: orange}
		}
		#signIn p {
			font-size: 35px;
			animation: dark 1.75s linear infinite;
		}
		.signInContainer {
		 width: 80%;
		 height: 80%;
		 background-color: white;
		 box-shadow: 0px 0px 15px white;
		 display: grid;
		 justify-items: center;
		 align-items: center;
		}
		</style>
	</head>
	<body>
		<header>
			<p class="dhp">DarkHeart Rewards</p>
			<p class="user">
				<!-- Load Users User Name Here -->
			</p>
			<p id="redeem">Points: <span class="points">677</span> (Click to Redeem)
			</p>
		</header>
		<p>Minute to Points conversion rate: 3 points / second</p>
		<div class="earn">
			<!-- The videos will be generated here from a script -->
		</div>
		<div class="stats">
			<p>Total Videos Watched: 25</p>
			<p>Total Links Clicked: 16</p>
			<p>Total Video Time Watched: 215</p>
			<p>Total Earnings from Videos: 645</p>
			<p>Total Earnings from Links: 32</p>
			<div class="logs">
				Logs:
				<p>Log</p>
			</div>
		</div>
		<div class="refer">
			<p>Refer friends to earn 1000 points each sign up!</p>
			<p>Click to Copy</p>
			<input id="referId" value="https://darkheartproductions.online/Dark%20Rewards%20New.html#DarkHeartProductions"/>
		</div>
		<footer>
		</footer>
		<div id="signIn">
			<div class="signInContainer">
				<p>DarkHeart Rewards</p>
				<div id="signInButton">
					<img src="Google Image.jpg">
					<span>Sign In / Sign Up using Google</span>
				</div>
				<div>A rewards program by DarkHeart Productions. Simple, and pays well.</div>
				<div>If you have any questions, email me at <a href="mailto:officialdarkheartproductions@gmail.com">officialdarkheartproductions@gmail.com</a></div>
			</div>
		</div>
		<div id="signUpDetails" style="display: none;">
			<div class="inputUsername">
				<input id="newUserName" placeholder="Username" />
			</div>
			<div class="referral">
				<p>Reffered? Put their Username here and you both get 500 Points!</p>
				<input id="referredBy" placeholder="Referral Code" />
				<div id="submitSignUp">
					Sign Up
				</div>
			</div>
		</div>
		<div class="overlay">
			<div>
				<p>Work In Progress (WIP), check back later to see updates.</p>
				<p>Whitelisted IPs:</p>
				<p>75.140.**.***</p>
			</div>
		</div>
	</body>
	<script>
	let data;
	function updateSigninStatus(isSignedIn) {
		Sheets.url = '1dRmFSE4nyfrPpH2VaM2EbHxhGgrEbfVSDs-y-GLgrZI';
		if (isSignedIn) {
			document.getElementById('signIn').style.display = 'none';
			Sheets.read('B2:B', function() {
				let result = Sheets.result;
				for (let i = 0; i < result.length; i++) {
					if (result[i][0] == gapi.auth2.getAuthInstance().currentUser.Ab.w3.U3) {
						i = result.length - 1;
						Sheets.read(`A${i + 2}:F${i + 2}`, function() {
							data = Sheets.result;
							let userName = data[0][0];
							let email = data[0][1];
							let points = data[0][2];
							let redemptionRequests = data[0][3];
							let userLogs = data[0][4];
							let timeStamps = data[0][5];
							let stats = data[0][6];
							let ref = document.getElementById('referId');
							ref.readOnly = true;
							ref.value = 'https://darkheartproductions.online/Dark%20Rewards%20New.html#' + userName;
							ref.onclick = function() {
								this.attributes.lastText = this.value;
								this.select();
								document.execCommand('copy');
								this.setSelectionRange(0, 0);
								this.value = 'Copied to Clipboard';
								setTimeout(function() {
									ref.value = ref.attributes.lastText;
								}, 1500);
							}
							for (let j = 0; j < document.getElementsByClassName('user').length; j++) {
								document.getElementsByClassName('user')[j].innerHTML = userName;
							}
							for (let k = 0; k < document.getElementsByClassName('points').length; k++) {
								document.getElementsByClassName('points')[k].innerHTML = points;
							}
							document.getElementsByClassName('logs')[0].innerHTML = userLogs;
						});
					} else {
						gapi.auth2.getAuthInstance().signOut().then(function() {
							alert('Signed Out.\nYou must sign up to start');
							location = location;
						});
					}
				}
			});
			ytads.videos = [];
		} else {
			document.getElementById('signIn').style.display = 'grid';
			document.getElementById('signInButton').onclick = function() {
				gapi.auth2.getAuthInstance().signIn().then(function() {
					Sheets.read('B2:B', function() {
						let data = Sheets.result;
						let con = false;
						if (document.getElementById('referredBy').value != '') {
							Sheets.read('A2:A', function() {
								let refDat = Sheets.result;
								for (let k = 0; k < refDat.length; k++) {
									if (refDat[i][0] == document.getElementById('referredBy').value) {
										con = true;
									} else {
										con = false;
									}
								}
							});
						} else {
							con = true;
						}
						function cont() {
							for (let i = 0; i < data.length; i++) {
								if (data[0][i] == gapi.auth2.getAuthInstance().currentUser.Ab.w3.U3) {
									location = location;
								} else {
									document.getElementById('signUpDetails').style.display = 'block';
									document.getElementById('submitSignUp').onclick = function() {
										Sheets.read('H7', function() {
											let length = Sheets.result;
											let writeArea = Number(length) + 1;
											Sheets.write(`A${writeArea}`, document.getElementById('newUserName').value);
											Sheets.write(`B${writeArea}`, gapi.auth2.getAuthInstance().currentUser.Ab.w3.U3);
											Sheets.write(`D${writeArea}`, '[]');
											Sheets.write(`E${writeArea}`, '[]');
											Sheets.write(`F${writeArea}`, '{}');
											Sheets.write(`G${writeArea}`, '{}');
											Sheets.write(`C${writeArea}`, 0);
										});
									}
								}
							}
						}
						if (con) {
							cont();
						} else {
							alert('No accounts found by this Referral Code.');
						}
					});
				});
			}
		}
	}
	function getIP(json) {
		if (json.ip == '75.140.27.241') {
			document.getElementsByClassName('overlay')[0].style.display = 'none';
		}
	}
	document.getElementById('redeem').onclick = function() {
		location = location.host + '/redeem.html';
	}
	</script>
	<script type="application/javascript" src="https://api.ipify.org?format=jsonp&callback=getIP"></script>
	<script src="YouTube Advert.js">
	</script>
	<script src="sheetsSimplifier.js">
	</script>
</html>
